2012-03-07  Matevz Tadel  <matevz.tadel@ijs.si>

	* Glasses/XrdMonSucker.cxx:
	When file-open trace is received, reset file-open time if it is
	further away in the past.

2012-03-06  Matevz Tadel  <matevz.tadel@ijs.si>

	* Glasses/XrdDomain.cxx:
	* Glasses/XrdDomain.h:
	* Glasses/XrdMonSucker.cxx:
	Add packet and failed seq-id counters to XrdDomain, too.

2012-03-05  Matevz Tadel  <matevz.tadel@ijs.si>

	* Glasses/XrdMonSucker.cxx:
	* Glasses/XrdMonSucker.h:
	* Glasses/XrdServer.cxx:
	* Glasses/XrdServer.h:
	Count packets processed and number of mis-matched seq-ids.

2012-02-29  Matevz Tadel  <matevz.tadel@ijs.si>

	Add processing of appinfo messages.

	* Glasses/XrdFileCloseReporter.cxx:
	Report app_info at file close.

	* Glasses/XrdMonSucker.cxx:
	Process 'i' messages and stick the text into the right XrdUser.

	* Glasses/XrdUser.cxx:
	* Glasses/XrdUser.h:
	Add member TString mAppInfo and method AppendAppInfo().

2012-02-28  Matevz Tadel  <matevz.tadel@ijs.si>

	Improve initialization of server sequence-id and logging.

	* Glasses/XrdFileCloseReporter.cxx:
	Send errors to ZLog.

	* Glasses/XrdMonSucker.cxx:
	Fix server seqence-id initialization (should only happen on one of
	the blessed message types).
	Log new-server reports as L_Message. L_Info is now used for
	logging of every processed packet.

	* Glasses/XrdServer.cxx:
	* Glasses/XrdServer.h:
	Add bool member needed to mark server sequence-id initialization.

2012-02-27  Matevz Tadel  <matevz.tadel@ijs.si>

	* Glasses/XrdFileCloseReporter.cxx:
	* Glasses/XrdFileCloseReporter.h:
	Add link member for ZLog.

	* Glasses/XrdMonSucker.cxx:
	Log uninteresting stuff as info, periodic cleanups as message.

2012-02-27  Matevz Tadel  <matevz.tadel@ijs.si>

	Rename libset CmsGridViz to XrdMon.

2012-02-27  Matevz Tadel  <matevz.tadel@ijs.si>

	Remove unused glasses in preparation for libset rename.

	* Glasses/CmsXrdHost.cxx:
	* Glasses/CmsXrdHost.h:
	* Glasses/CmsXrdSite.cxx:
	* Glasses/CmsXrdSite.h:
	* Glasses/CmsXrdUser.cxx:
	* Glasses/CmsXrdUser.h:
	Removed glasses ... they never got used.

	* glass.list:
	Unregister CmsXrd classes.

2012-02-24  Matevz Tadel  <matevz.tadel@ijs.si>

	* Glasses/UdpPacketListener.cxx:
	* Glasses/UdpPacketListener.h:
	* Glasses/UdpPacketSource.cxx:
	* Glasses/UdpPacketSource.h:
	* Glasses/UdpPacketTcpClient.cxx:
	* Glasses/UdpPacketTcpClient.h:
	* Glasses/UdpPacketTcpServer.cxx:
	* Glasses/UdpPacketTcpServer.h:
	* Glasses/UdpPacketTreeWriter.cxx:
	* Glasses/UdpPacketTreeWriter.h:
	Move to new libset Net1.

	* Glasses/XrdMonSucker.cxx:
	* glass.list:
	Modify as needed for UdpXyzz class move.

	* Makefile:
	Add dependency on Net1 libset.

2012-02-23  Matevz Tadel  <matevz.tadel@ijs.si>

	* Glasses/XrdEhs.cxx:
	Set default port to 4242.

	* Glasses/XrdFileCloseReporter.cxx:
	Set default to localhost:4242.
	Use AF_INET family, AF_UNSPEC picks up IP6 for localhost.

2012-02-06  Matevz Tadel  <matevz.tadel@ijs.si>

	* Glasses/UdpPacketTcpClient.cxx:
	Comment debug printout.

	* Glasses/UdpPacketTcpServer.cxx:
	Grayspace.

	* Glasses/XrdMonSucker.cxx:
	Decrease ref-count on packet when done with it.

2012-01-31  Matevz Tadel  <matevz.tadel@ijs.si>

	* Glasses/UdpPacketTcpServer.cxx:
	Use recursive mutex for GSelector. There is double locking in
	RemoveClient() when called with TSocket* argument.

2012-01-30  Matevz Tadel  <matevz.tadel@ijs.si>

	Major restructuring to support various monitoring-data collection
	setups.

	* Glasses/UdpPacketListener.cxx:
	* Glasses/UdpPacketListener.h:
	* Glasses/UdpPacketSource.cxx:
	* Glasses/UdpPacketSource.h:
	* Glasses/UdpPacketTcpServer.cxx:
	* Glasses/UdpPacketTcpServer.h:
	* Glasses/UdpPacketTreeWriter.cxx:
	* Glasses/UdpPacketTreeWriter.h:
	New files - restructuring of functionality from UdpPacketProcessor
	and XrdMonSucker.

	* Glasses/UdpPacketProcessor.cxx:
	* Glasses/UdpPacketProcessor.h:
	Removed files - split into UdpPacketListener and UdpPacketTcpServer.

	* Glasses/UdpPacketTcpClient.cxx:
	* Glasses/UdpPacketTcpClient.h:
	Subclass from (almost abstract) UdpPacketSource.

	* Glasses/XrdMonSucker.cxx:
	* Glasses/XrdMonSucker.h:
	Remove UDP packet slurping code, register to a UdpPacketSource to
	receive SUdpMessages.

	* glass.list:
	Register all the glass changes.

2012-01-24  Matevz Tadel  <matevz.tadel@ijs.si>

	* Glasses/UdpPacketProcessor.cxx:
	Reduce printout, make receive buffer 64k (on stack, hmmh).

2012-01-19  Matevz Tadel  <matevz.tadel@ijs.si>

	Improve reporting, thread handling.

	* Glasses/UdpPacketProcessor.cxx:
	* Glasses/UdpPacketProcessor.h:
	Improve logging and error reporting, add link to ZLog.

	* Glasses/UdpPacketTcpClient.cxx:
	* Glasses/UdpPacketTcpClient.h:
	Improve thread handling and error reporting.

2012-01-17  Matevz Tadel  <matevz.tadel@ijs.si>

	* Glasses/XrdEhs.cxx:
	Fix half-cooked cut-n-paste crap.
	Update class docs.

2012-01-17  Matevz Tadel  <matevz.tadel@ijs.si>

	Basic parsing of request and arguments for table filtering.

	* Glasses/XrdEhs.cxx:
	* Glasses/XrdEhs.h:
	Parse the GET request (first line only).
	Parse and split the arguments.
	Pass those to table filling function where filters are created
	based on those values.

2012-01-06  Matevz Tadel  <matevz.tadel@ijs.si>

	Proto-verison of UDP packet processor and its client.

	* Glasses/UdpPacketProcessor.cxx:
	* Glasses/UdpPacketProcessor.h:
	New glass - listen for UDP packets and forward them to connected
	clients over TCP, streamed as SUdpPacket.

	* Glasses/UdpPacketTcpClient.cxx:
	* Glasses/UdpPacketTcpClient.h:
	New glass - TCP client for UdpPacketProcessor. Can deliver packets
	to several local consumers using GQueueSet.

	* glass.list:
	Register UdpPacketProcessor and UdpPacketTcpClient.

2012-01-06  Matevz Tadel  <matevz.tadel@ijs.si>

	* Stones/SUdpPacket.cxx:
	* Stones/SUdpPacket.h:
	Move SUdpPacket to GledCore.

2012-01-06  Matevz Tadel  <matevz.tadel@ijs.si>

	* Stones/SUdpPacket.cxx:
	* Stones/SUdpPacket.h:
	Use fixed-size array for from address.

2011-12-19  Matevz Tadel  <matevz.tadel@ijs.si>

	* Glasses/XrdMonSucker.cxx:
	File-ids were not unregistered when whole sessions were closed
	down via timeouts.

2011-12-12  Matevz Tadel  <matevz.tadel@ijs.si>

	* Glasses/XrdEhs.cxx:
	Safer server start/stop procedure.

2011-12-08  Matevz Tadel  <matevz.tadel@ijs.si>

	Add cleaning of inactive users.

	* Glasses/XrdMonSucker.cxx:
	* Glasses/XrdMonSucker.h:
	Add method CleanUpDeadUsers() and surrounding members.
	Add basic processing of '=' messages - need to extend it to
	actually detect server restarts.

2011-12-02  Matevz Tadel  <matevz.tadel@ijs.si>

	Parse, store and report file size.

	* Glasses/XrdFile.cxx:
	* Glasses/XrdFile.h:
	Add member for file size - Double_t mSizeMB.

	* Glasses/XrdFileCloseReporter.cxx:
	Report file-size.

	* Glasses/XrdMonSucker.cxx:
	Parse file-size form the open-trace, store it in XrdFile.

2011-11-14  Matevz Tadel  <matevz.tadel@ijs.si>

	Session handling and logging fixes.

	* Glasses/XrdMonSucker.cxx:
	Call XrdServer::DisconnectUser() under write lock (instead of MIR).
	When a user-name exists under given server, wipe the old one
	(we are getting weird stuff from MIT).
	Log file open/close and user disconnects.

2011-11-13  Matevz Tadel  <matevz.tadel@ijs.si>

	* Glasses/XrdMonSucker.cxx:
	* Glasses/XrdServer.cxx:
	Consistenly use assign_link<>() in AdEnlightenment().

2011-11-09  Matevz Tadel  <matevz.tadel@ijs.si>

	* Glasses/XrdMonSucker.cxx:
	Finish conversion to ZLog usage.

2011-11-09  Matevz Tadel  <matevz.tadel@ijs.si>

	Mostly convert to using ZLog.

	* Glasses/XrdMonSucker.cxx:
	* Glasses/XrdMonSucker.h:
	Add link to ZLog.
	Use this (via ZLog::Helper) to print stuff in a file.
	Trace debugging is still going to stdout.

2011-11-06  Matevz Tadel  <matevz.tadel@ijs.si>

	Fix response header, serve response in a detached thread.

	* Glasses/XrdEhs.cxx:
	* Glasses/XrdEhs.h:
	Serve a page in a detached thread (still doesn't read request).
	Sleep for a second after sending (get ack would be better).
	Use proper date format, usr crlf line ends in header.

2011-11-04  Matevz Tadel  <matevz.tadel@ijs.si>

	* Glasses/XrdEhs.cxx:
	Improve response header a bit.

2011-11-04  Matevz Tadel  <matevz.tadel@ijs.si>

	EHS was locking up, use home-cooked "web server".

	* Glasses/XrdEhs.cxx:
	Use direct sockets and just dump the table.
	The request is not even read.

	* Makefile:
	Remove dependency on EHS libset.

2011-11-04  Matevz Tadel  <matevz.tadel@ijs.si>

	Fix deadlock coming from XrdServer::DisconnectUser().

	* Glasses/XrdMonSucker.cxx:
	Call XrdServer::DisconnectUser() via a MIR (write-lock should be
	sufficient, in principle).

	* Glasses/XrdServer.cxx:
	* Glasses/XrdServer.h:
	Make user / file managemnet functions MIR-invokable.

2011-11-03  Matevz Tadel  <matevz.tadel@ijs.si>

	* Glasses/XrdMonSucker.cxx:
	Handle new disconnect trace flags (forced, boundp).

2011-11-02  Alja Mrak-Tadel  <Alja.Mrak.Tadel@cern.ch>

	* Glasses/XrdEhs.cxx:
	Display OpenTime as time elapsed since opening of the file.

2011-11-02  Matevz Tadel  <matevz.tadel@ijs.si>

	Display real name in html table.

	* Glasses/XrdEhs.cxx:
	Change header to "User" and use GetRealName() to get it from
	XrdUser.

	* Glasses/XrdUser.cxx:
	* Glasses/XrdUser.h:
	Add TString member mRealName, fill it in constructor.
	Rename GetHumanName() to ParseHumanName() and make it public.

2011-11-02  Matevz Tadel  <matevz.tadel@ijs.si>

	* CmsGridViz/XrdXrootdMonData.h:
	Add disconnect bits - forced and boundp.

2011-11-01  Alja Mrak-Tadel  <Alja.Mrak.Tadel@cern.ch>

	* Glasses/XrdUser.cxx:
	* Glasses/XrdUser.h:
	Add static function to get human name from DN.

2011-11-01  Matevz Tadel  <matevz.tadel@ijs.si>

	* Glasses/XrdEhs.cxx:
	* Glasses/XrdEhs.h:
	Rename link mXrdReporter to mXrdSucker.
	Reporter is file-close-reporter.

2011-11-01  Matevz Tadel  <matevz.tadel@ijs.si>

	* Glasses/XrdMonSucker.cxx:
	Set open/last-msg time on a file when file-map message is
	received. Don't wait until the first trace.

2011-11-01  Matevz Tadel  <matevz.tadel@ijs.si>

	* Glasses/XrdEhs.cxx:
	* Glasses/XrdEhs.h:
	* Glasses/XrdEHS.cxx:
	* Glasses/XrdEHS.h:
	* glass.list:
	Rename XrdEHS to XrdEhs (consistent capitalization with other
	classes in this libset).

2011-11-01  Matevz Tadel  <matevz.tadel@ijs.si>

	Standardize constructor & link usage.

	* Glasses/XrdEHS.cxx:
	* Glasses/XrdEHS.h:
	Make XrdMonSucker a ZLink.
	Use standard constructor arguments.
	Put sub-class of EHS into an unnamed namespace.

2011-11-01  Matevz Tadel  <matevz.tadel@ijs.si>

	Add old session/server clean-up; improve locking.

	* Glasses/XrdDomain.cxx:
	* Glasses/XrdDomain.h:
	New glass representing a domain.

	* Stones/SUdpPacket.cxx:
	* Stones/SUdpPacket.h:
	New stone holding a UDP packet stamped with time and sender info.

	* Stones/SXrdServerId.cxx:
	* Stones/SXrdServerId.h:
	New stone holding unique identification of a xrootd server.

	* Glasses/XrdMonSucker.cxx:
	* Glasses/XrdMonSucker.h:
	Add functions to clean up old user-sessions and servers:
	  void CleanUpOldUsers();
	  void CleanUpOldServers();
	Add another thread that checks how much time has passed and calls
	the clean-up functions when needed.
	Improved locking.

	* Glasses/XrdServer.cxx:
	* Glasses/XrdServer.h:
	Store unique server id in the class itself.
	Improved locking.

	* Glasses/XrdFile.cxx:
	* Glasses/XrdFile.h:
	* Glasses/XrdUser.cxx:
	* Glasses/XrdUser.h:
	Store file/user dict-id in the class itself.
	Improved locking.

	* glass.list:
	Register XrdDomain.

2011-11-01  Matevz Tadel  <matevz.tadel@ijs.si>

	* Glasses/XrdMonSucker.cxx:
	Also process sessions for which there is no user authentication info.

2011-10-28  Alja Mrak-Tadel  <Alja.Mrak.Tadel@cern.ch>

	* Glasses/XrdEHS.cxx:
	Add number of opened files in page html title.

2011-10-27  Matevz Tadel  <matevz.tadel@ijs.si>

	* Glasses/XrdMonSucker.cxx:
	Better warnings, and less of them.

2011-10-26  Alja Mrak-Tadel  <Alja.Mrak.Tadel@cern.ch>

	* Glasses/XrdEHS.cxx:
	Cache copy of opened files.

2011-10-26  Alja Mrak-Tadel  <Alja.Mrak.Tadel@cern.ch>

	* Glasses/XrdEHS.cxx:
	Add two columns for time of last update and total bytes read.

2011-10-24  Alja Mrak-Tadel  <Alja.Mrak.Tadel@cern.ch>

	* Glasses/XrdEHS.cxx:
	Change table content.

	* Makefile:
	Add dependency to EHS libset.

	* glass.list:
	Change XrdEHS class id.

2011-10-21  Alja Mrak-Tadel  <Alja.Mrak.Tadel@cern.ch>

	* Glasses/XrdEHS.cxx:
	* Glasses/XrdEHS.h:
	First version of embedded http server to provide a web page with info
	about open files, its users, etc.

	* glass.list:
	New XrdEHS class.

2011-10-13  Matevz Tadel  <matevz.tadel@ijs.si>

	* Glasses/XrdMonSucker.cxx:
	Do not filter nagios records by default.
	Support also "old" auth record format.

2011-10-10  Matevz Tadel  <matevz.tadel@ijs.si>

	Expand in sync with development in xrootd.

	* CmsGridViz/XrdXrootdMonData.h:
	Update for changes in vector read monitoring in xrootd.

	* Glasses/XrdFileCloseReporter.cxx:
	Write out user group as user_fqan.

	* Glasses/XrdMonSucker.cxx:
	Add processing of group info in auth monitoring message.
	Add prelimiary processing of vector-read traces.

	* Glasses/XrdUser.cxx:
	* Glasses/XrdUser.h:
	Add member TString mGroup.

2011-10-10  Matevz Tadel  <matevz.tadel@ijs.si>

	* Glasses/XrdMonSucker.cxx:
	Reset XrdServer-stored seq-id after mismatch.
	Add time and server-name to seq-id mismatch warning.

2011-10-10  Matevz Tadel  <matevz.tadel@ijs.si>

	* Glasses/XrdMonSucker.cxx:
	* Glasses/XrdMonSucker.h:
	Add dedicated list holding currently opened files.

2011-10-06  Matevz Tadel  <matevz.tadel@ijs.si>

	Fixes for production readiness of Gratia dumper.

	* Glasses/XrdFileCloseReporter.cxx:
	Add "xrd-" prefix to unique id.

	* Glasses/XrdMonSucker.cxx:
	* Glasses/XrdMonSucker.h:
	Set element FID for self and for domain-list.
	Set keep-sorted flag in domain-list.
	Reverse domain/host order in XrdServer name.
	Add initialization / check / warning for server sequence-id.
	Fix a byte - Mbyte conversion.
	Fix reading of "bytes-written" offset out of trace message.

	* Glasses/XrdServer.h:
	Add sequence-id data-member and init/query functions.
	Fix a byte - Mbyte conversion.

2011-10-05  Alja Mrak-Tadel  <Alja.Mrak.Tadel@cern.ch>

	* Glasses/XrdMonSucker.cxx:
	Group XrdServer objects by domain name.

2011-09-29  Matevz Tadel  <matevz.tadel@ijs.si>

	Add unique-id and username used at xrootd server to file-close
	report.

	* Glasses/XrdFileCloseReporter.cxx:
	* Glasses/XrdFileCloseReporter.h:
	Also dump unique-id and username used at xrootd server.

	* Glasses/XrdMonSucker.cxx:
	Pass username used at xrootd server when instantiating an XrdUser.

	* Glasses/XrdUser.cxx:
	* Glasses/XrdUser.h:
	Add data-member for storing username used at xrootd server:
	  TString mServerUsername;

2011-09-28  Matevz Tadel  <matevz.tadel@ijs.si>

	Improve printout formats.

	* Glasses/XrdFile.h:
	Reduce precision of Read/WriteStats in StoneOutput weed.

	* Glasses/XrdFileCloseReporter.cxx:
	Cleanup printout.

	* Glasses/XrdMonSucker.cxx:
	Add date/time info to message printout.

2011-09-27  Matevz Tadel  <matevz.tadel@ijs.si>

	Step 3 in file-close reporting.

	* Glasses/XrdFile.cxx:
	* Glasses/XrdFile.h:
	Use SRange for storing read/write trace statistics.

	* Glasses/XrdFileCloseReporter.cxx:
	* Glasses/XrdFileCloseReporter.h:
	Dump all the stuff to UDP port.
	Beautify reporter-thread management.

	* Glasses/XrdMonSucker.cxx:
	* Glasses/XrdMonSucker.h:
	Use getaddrinfo() for initial setup.
	The revfrom() call still uses ip4 structs.
	Beautify suck-thread management.

2011-09-26  Matevz Tadel  <matevz.tadel@ijs.si>

	Step 2 in file-close reporting.

	* Glasses/XrdFileCloseReporter.cxx:
	* Glasses/XrdFileCloseReporter.h:
	Add thread management and notification queue.

	* Glasses/XrdMonSucker.cxx:
	* Glasses/XrdMonSucker.h:
	Add link to XrdFileCloseReporter, call it when a file is closed.

2011-09-26  Matevz Tadel  <matevz.tadel@ijs.si>

	Prelimiary commit of file-close reporting.

	* Glasses/XrdFileCloseReporter.cxx:
	* Glasses/XrdFileCloseReporter.h:
	Proto version.

	* Glasses/XrdMonSucker.h:
	Mostly comments about handling of XrdFileCloseReporter.

	* glass.list:
	Register XrdFileCloseReporter.

2011-09-22  Matevz Tadel  <matevz.tadel@ijs.si>

	* Glasses/XrdUser.h:
	When a XrdUser disconnects, check all its files to see if they are
	open -- and close them.

	* Glasses/XrdFile.h:
	Add function Bool_t IsOpen().

	* Glasses/XrdMonSucker.cxx:
	Add function Bool_t IsConnected().

2011-09-09  Matevz Tadel  <matevz.tadel@ijs.si>

	Finalize front-line processing of xrootd monitoring streams.

	* Glasses/XrdMonSucker.cxx:
	Use new functions from XrdServer, proper dict_id de-registration.
	Lock lenses when doing direct calls on them; those should be MIRs,
	anyway.
	Make code somewhat prettier.

	* Glasses/XrdServer.cxx:
	* Glasses/XrdServer.h:
	Add new owned link:
	   ZLink<ZList> mPrevUsers;
	initialize it in AdEnlightenment() and add the following functions:
	   void DisconnectUser(XrdUser* user, Int_t dict_id);
	   void RemoveUser(XrdUser* user);
	   void RemoveFile(XrdFile* file, Int_t dict_id);
	to help managing users and files ... and their dict_id maps.

	* Glasses/XrdUser.cxx:
	Docs.

	* Glasses/XrdFile.h:
	Whitespace.

2011-09-02  Matevz Tadel  <matevz.tadel@ijs.si>

	Complete parsing of xrd monitor stream -- all information is now
	processed.

	* Glasses/XrdFile.cxx:
	* Glasses/XrdFile.h:
	* glass.list:
	New glass representing an open file in a xrd session.

	* Glasses/XrdMonSucker.cxx:
	* Glasses/XrdMonSucker.h:
	Finalize parsing of monitor stream, including IO traces.
	Use user, host & domain matching to filter out nagios probes.
	Use DN, host & domain REs to select sessions whose traces are to
	be dumped into the log.

	* Glasses/XrdServer.cxx:
	* Glasses/XrdServer.h:
	Add start, last-msg times.

	* Glasses/XrdUser.cxx:
	* Glasses/XrdUser.h:
	Add connect, disconnect, last-msg times.
	Add DN, VO and role details.

2011-06-29  Matevz Tadel  <matevz.tadel@ijs.si>

	Add start / connect time into to XrdServer and XrdUser.

	* Glasses/XrdServer.cxx:
	* Glasses/XrdServer.h:
	* Glasses/XrdUser.cxx:
	* Glasses/XrdUser.h:
	Add start-time.

	* Glasses/XrdMonSucker.cxx:
	* Glasses/XrdMonSucker.h:
	Pass start / connect time to XrdServer/User at creation time.

2011-06-24  Matevz Tadel  <matevz.tadel@ijs.si>

	Populate state with XrdServer and XrdUser lenses - this is slowly
	getting functional.

	* Glasses/CmsXrdSite.cxx:
	* Glasses/CmsXrdSite.h:
	* Glasses/CmsXrdUser.cxx:
	* Glasses/CmsXrdUser.h:
	* Glasses/XrdUser.cxx:
	* Glasses/XrdUser.h:
	New glasses - hold data about sites, users.

	* glass.list:
	Register new glasses.

	* Glasses/XrdMonSucker.cxx:
	* Glasses/XrdMonSucker.h:
	Improve reception of incoming data. Actually create XrdServer and
	XrdUser lenses to represent what is going on.

	* Glasses/XrdServer.cxx:
	* Glasses/XrdServer.h:
	Add mHost and mDomain members.

2011-06-19  Matevz Tadel  <matevz.tadel@ijs.si>

	First commit -- still incomplete.
